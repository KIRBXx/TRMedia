!function(a){var b=function(c,d){var g=/[^\w\-\.:]/.test(c)?new Function(b.arg+",tmpl","var _e=tmpl.encode"+b.helper+",_s='"+c.replace(b.regexp,b.func)+"';return _s;"):b.cache[c]=b.cache[c]||b(b.load(c));return d?g(d,b):function(e){return g(e,b)}};b.cache={},b.load=function(c){return document.getElementById(c).innerHTML},b.regexp=/([\s'\\])(?!(?:[^{]|\{(?!%))*%\})|(?:\{%(=|#)([\s\S]+?)%\})|(\{%)|(%\})/g,b.func=function(m,n,c,d,e,f){return n?{"\n":"\\n","\r":"\\r","	":"\\t"," ":" "}[n]||"\\"+n:c?"="===c?"'+_e("+d+")+'":"'+("+d+"==null?'':"+d+")+'":e?"';":f?"_s+='":void 0},b.encReg=/[<>&"'\x00]/g,b.encMap={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;"},b.encode=function(c){return(null==c?"":""+c).replace(b.encReg,function(d){return b.encMap[d]||""})},b.arg="o",b.helper=",print=function(s,e){_s+=e?(s==null?'':s):_e(s);},include=function(s,d){_s+=tmpl(s,d);}","function"==typeof define&&define.amd?define(function(){return b}):a.tmpl=b}(this);!function(b){var c=function(d,e,f){var g,m,n=document.createElement("img");if(n.onerror=e,n.onload=function(){!m||f&&f.noRevoke||c.revokeObjectURL(m),e&&e(c.scale(n,f))},c.isInstanceOf("Blob",d)||c.isInstanceOf("File",d)){g=m=c.createObjectURL(d),n._type=d.type}else{if("string"!=typeof d){return !1}g=d,f&&f.crossOrigin&&(n.crossOrigin=f.crossOrigin)}return g?(n.src=g,n):c.readFile(d,function(h){var i=h.target;i&&i.result?n.src=i.result:e&&e(h)})},a=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;c.isInstanceOf=function(d,e){return Object.prototype.toString.call(e)==="[object "+d+"]"},c.transformCoordinates=function(){},c.getTransformedOptions=function(d){return d},c.renderImageToCanvas=function(v,w,d,e,f,g,h,i,j,u){return v.getContext("2d").drawImage(w,d,e,f,g,h,i,j,u),v},c.hasCanvasOption=function(d){return d.canvas||d.crop},c.scale=function(d,e){e=e||{};var g,i,k,m,p,q,r,s,t,M=document.createElement("canvas"),f=d.getContext||c.hasCanvasOption(e)&&M.getContext,h=d.naturalWidth||d.width,j=d.naturalHeight||d.height,l=h,n=j,o=function(){var u=Math.max((k||l)/l,(m||n)/n);u>1&&(l=Math.ceil(l*u),n=Math.ceil(n*u))},N=function(){var u=Math.min((g||l)/l,(i||n)/n);1>u&&(l=Math.ceil(l*u),n=Math.ceil(n*u))};return f&&(e=c.getTransformedOptions(e),r=e.left||0,s=e.top||0,e.sourceWidth?(p=e.sourceWidth,void 0!==e.right&&void 0===e.left&&(r=h-p-e.right)):p=h-r-(e.right||0),e.sourceHeight?(q=e.sourceHeight,void 0!==e.bottom&&void 0===e.top&&(s=j-q-e.bottom)):q=j-s-(e.bottom||0),l=p,n=q),g=e.maxWidth,i=e.maxHeight,k=e.minWidth,m=e.minHeight,f&&g&&i&&e.crop?(l=g,n=i,t=p/q-g/i,0>t?(q=i*p/g,void 0===e.top&&void 0===e.bottom&&(s=(j-q)/2)):t>0&&(p=g*q/i,void 0===e.left&&void 0===e.right&&(r=(h-p)/2))):((e.contain||e.cover)&&(k=g=g||k,m=i=i||m),e.cover?(N(),o()):(o(),N())),f?(M.width=l,M.height=n,c.transformCoordinates(M,e),c.renderImageToCanvas(M,d,r,s,p,q,0,0,l,n)):(d.width=l,d.height=n,d)},c.createObjectURL=function(d){return a?a.createObjectURL(d):!1},c.revokeObjectURL=function(d){return a?a.revokeObjectURL(d):!1},c.readFile=function(f,k,d){if(window.FileReader){var e=new FileReader;if(e.onload=e.onerror=k,d=d||"readAsDataURL",e[d]){return e[d](f),e}}return !1},"function"==typeof define&&define.amd?define(function(){return c}):b.loadImage=c}(this),function(a){"function"==typeof define&&define.amd?define(["load-image"],a):a(window.loadImage)}(function(a){if(window.navigator&&window.navigator.platform&&/iP(hone|od|ad)/.test(window.navigator.platform)){var b=a.renderImageToCanvas;a.detectSubsampling=function(d){var h,c;return d.width*d.height>1048576?(h=document.createElement("canvas"),h.width=h.height=1,c=h.getContext("2d"),c.drawImage(d,-d.width+1,0),0===c.getImageData(0,0,1,1).data[3]):!1},a.detectVerticalSquash=function(u,v){var c,d,e,f,g,h=u.naturalHeight||u.height,i=document.createElement("canvas"),j=i.getContext("2d");for(v&&(h/=2),i.width=1,i.height=h,j.drawImage(u,0,0),c=j.getImageData(0,0,1,h).data,d=0,e=h,f=h;f>d;){g=c[4*(f-1)+3],0===g?e=f:d=f,f=e+d>>1}return f/h||1},a.renderImageToCanvas=function(d,f,h,j,l,n,o,p,q,r){if("image/jpeg"===f._type){var c,e,g,i,k=d.getContext("2d"),m=document.createElement("canvas"),s=1024,t=m.getContext("2d");if(m.width=s,m.height=s,k.save(),c=a.detectSubsampling(f),c&&(h/=2,j/=2,l/=2,n/=2),e=a.detectVerticalSquash(f,c),c||1!==e){for(j*=e,q=Math.ceil(s*q/l),r=Math.ceil(s*r/n/e),p=0,i=0;n>i;){for(o=0,g=0;l>g;){t.clearRect(0,0,s,s),t.drawImage(f,h,j,l,n,-g,-i,l,n),k.drawImage(m,0,0,s,s,o,p,q,r),g+=s,o+=q}i+=s,p+=r}return k.restore(),d}}return b(d,f,h,j,l,n,o,p,q,r)}}}),function(a){"function"==typeof define&&define.amd?define(["load-image"],a):a(window.loadImage)}(function(a){var b=a.hasCanvasOption;a.hasCanvasOption=function(c){return b(c)||c.orientation},a.transformCoordinates=function(m,n){var c=m.getContext("2d"),d=m.width,e=m.height,f=n.orientation;if(f){switch(f>4&&(m.width=e,m.height=d),f){case 2:c.translate(d,0),c.scale(-1,1);break;case 3:c.translate(d,e),c.rotate(Math.PI);break;case 4:c.translate(0,e),c.scale(1,-1);break;case 5:c.rotate(0.5*Math.PI),c.scale(1,-1);break;case 6:c.rotate(0.5*Math.PI),c.translate(0,-e);break;case 7:c.rotate(0.5*Math.PI),c.translate(d,-e),c.scale(-1,1);break;case 8:c.rotate(-0.5*Math.PI),c.translate(-d,0)}}},a.getTransformedOptions=function(d){if(!d.orientation||1===d.orientation){return d}var h,c={};for(h in d){d.hasOwnProperty(h)&&(c[h]=d[h])}switch(d.orientation){case 2:c.left=d.right,c.right=d.left;break;case 3:c.left=d.right,c.top=d.bottom,c.right=d.left,c.bottom=d.top;break;case 4:c.top=d.bottom,c.bottom=d.top;break;case 5:c.left=d.top,c.top=d.left,c.right=d.bottom,c.bottom=d.right;break;case 6:c.left=d.top,c.top=d.right,c.right=d.bottom,c.bottom=d.left;break;case 7:c.left=d.bottom,c.top=d.right,c.right=d.top,c.bottom=d.left;break;case 8:c.left=d.bottom,c.top=d.left,c.right=d.top,c.bottom=d.right}return d.orientation>4&&(c.maxWidth=d.maxHeight,c.maxHeight=d.maxWidth,c.minWidth=d.minHeight,c.minHeight=d.minWidth,c.sourceWidth=d.sourceHeight,c.sourceHeight=d.sourceWidth),c}}),function(a){"function"==typeof define&&define.amd?define(["load-image"],a):a(window.loadImage)}(function(a){var b=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);a.blobSlice=b&&function(){var c=this.slice||this.webkitSlice||this.mozSlice;return c.apply(this,arguments)},a.metaDataParsers={jpeg:{65505:[]}},a.parseMetaData=function(e,o,c){c=c||{};var d=this,f=c.maxMetaDataSize||262144,g={},h=!(window.DataView&&e&&e.size>=12&&"image/jpeg"===e.type&&a.blobSlice);(h||!a.readFile(a.blobSlice.call(e,0,f),function(n){var x,y,z,A,i=n.target.result,j=new DataView(i),k=2,l=j.byteLength-4,m=k;if(65496===j.getUint16(0)){for(;l>k&&(x=j.getUint16(k),x>=65504&&65519>=x||65534===x);){if(y=j.getUint16(k+2)+2,k+y>j.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(z=a.metaDataParsers.jpeg[x]){for(A=0;A<z.length;A+=1){z[A].call(d,j,k,y,g,c)}}k+=y,m=k}!c.disableImageHead&&m>6&&(g.imageHead=i.slice?i.slice(0,m):new Uint8Array(i).subarray(0,m))}else{console.log("Invalid JPEG file: Missing JPEG marker.")}o(g)},"readAsArrayBuffer"))&&o(g)}}),function(a){"function"==typeof define&&define.amd?define(["load-image","load-image-meta"],a):a(window.loadImage)}(function(a){a.ExifMap=function(){return this},a.ExifMap.prototype.map={Orientation:274},a.ExifMap.prototype.get=function(b){return this[b]||this[this.map[b]]},a.getExifThumbnail=function(f,m,b){var c,d,e;if(!b||m+b>f.byteLength){return console.log("Invalid Exif data: Invalid thumbnail data."),void 0}for(c=[],d=0;b>d;d+=1){e=f.getUint8(m+d),c.push((16>e?"0":"")+e.toString(16))}return"data:image/jpeg,%"+c.join("%")},a.exifTagTypes={1:{getValue:function(b,e){return b.getUint8(e)},size:1},2:{getValue:function(b,e){return String.fromCharCode(b.getUint8(e))},size:1,ascii:!0},3:{getValue:function(c,g,b){return c.getUint16(g,b)},size:2},4:{getValue:function(c,g,b){return c.getUint32(g,b)},size:4},5:{getValue:function(c,g,b){return c.getUint32(g,b)/c.getUint32(g+4,b)},size:8},9:{getValue:function(c,g,b){return c.getInt32(g,b)},size:4},10:{getValue:function(c,g,b){return c.getInt32(g,b)/c.getInt32(g+4,b)},size:8}},a.exifTagTypes[7]=a.exifTagTypes[1],a.getExifValue=function(f,g,i,j,k,l){var m,n,b,c,d,e,h=a.exifTagTypes[j];if(!h){return console.log("Invalid Exif data: Invalid tag type."),void 0}if(m=h.size*k,n=m>4?g+f.getUint32(i+8,l):i+8,n+m>f.byteLength){return console.log("Invalid Exif data: Invalid data offset."),void 0}if(1===k){return h.getValue(f,n,l)}for(b=[],c=0;k>c;c+=1){b[c]=h.getValue(f,n+c*h.size,l)}if(h.ascii){for(d="",c=0;c<b.length&&(e=b[c],"\x00"!==e);c+=1){d+=e}return d}return b},a.parseExifTag=function(c,b,d,e,f){var g=c.getUint16(d,e);f.exif[g]=a.getExifValue(c,b,d,c.getUint16(d+2,e),c.getUint32(d+4,e),e)},a.parseExifTags=function(e,f,g,h,q){var b,c,d;if(g+6>e.byteLength){return console.log("Invalid Exif data: Invalid directory offset."),void 0}if(b=e.getUint16(g,h),c=g+2+12*b,c+4>e.byteLength){return console.log("Invalid Exif data: Invalid directory size."),void 0}for(d=0;b>d;d+=1){this.parseExifTag(e,f,g+2+12*d,h,q)}return e.getUint32(c,h)},a.parseExifData=function(b,c,d,e,f){if(!f.disableExif){var g,h,i,j=c+10;if(1165519206===b.getUint32(c+4)){if(j+8>b.byteLength){return console.log("Invalid Exif data: Invalid segment size."),void 0}if(0!==b.getUint16(c+8)){return console.log("Invalid Exif data: Missing byte alignment offset."),void 0}switch(b.getUint16(j)){case 18761:g=!0;break;case 19789:g=!1;break;default:return console.log("Invalid Exif data: Invalid byte alignment marker."),void 0}if(42!==b.getUint16(j+2,g)){return console.log("Invalid Exif data: Missing TIFF marker."),void 0}h=b.getUint32(j+4,g),e.exif=new a.ExifMap,h=a.parseExifTags(b,j,j+h,g,e),h&&!f.disableExifThumbnail&&(i={exif:{}},h=a.parseExifTags(b,j,j+h,g,i),i.exif[513]&&(e.exif.Thumbnail=a.getExifThumbnail(b,j+i.exif[513],i.exif[514]))),e.exif[34665]&&!f.disableExifSub&&a.parseExifTags(b,j,j+e.exif[34665],g,e),e.exif[34853]&&!f.disableExifGps&&a.parseExifTags(b,j,j+e.exif[34853],g,e)}}},a.metaDataParsers.jpeg[65505].push(a.parseExifData)}),function(a){"function"==typeof define&&define.amd?define(["load-image","load-image-exif"],a):a(window.loadImage)}(function(a){a.ExifMap.prototype.tags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},a.ExifMap.prototype.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"top-left",2:"top-right",3:"bottom-right",4:"bottom-left",5:"left-top",6:"right-top",7:"right-bottom",8:"left-bottom"}},a.ExifMap.prototype.getText=function(b){var e=this.get(b);switch(b){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[b][e];case"ExifVersion":case"FlashpixVersion":return String.fromCharCode(e[0],e[1],e[2],e[3]);case"ComponentsConfiguration":return this.stringValues[b][e[0]]+this.stringValues[b][e[1]]+this.stringValues[b][e[2]]+this.stringValues[b][e[3]];case"GPSVersionID":return e[0]+"."+e[1]+"."+e[2]+"."+e[3]}return String(e)},function(d){var i,b=d.tags,c=d.map;for(i in b){b.hasOwnProperty(i)&&(c[b[i]]=i)}}(a.ExifMap.prototype),a.ExifMap.prototype.getAll=function(){var c,g,b={};for(c in this){this.hasOwnProperty(c)&&(g=this.tags[c],g&&(b[g]=this.getText(g)))}return b}});(function(b){if(typeof define==="function"&&define.amd){define(["jquery","jquery.ui.widget"],b)}else{b(window.jQuery)}}(function(b){b.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||b('<input type="file">').prop("disabled"));b.support.xhrFileUpload=!!(window.ProgressEvent&&window.FileReader);b.support.xhrFormDataFileUpload=!!window.FormData;b.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);b.widget("blueimp.fileupload",{options:{dropZone:b(document),pasteZone:b(document),fileInput:undefined,replaceFileInput:true,paramName:undefined,singleFileUploads:true,limitMultiFileUploads:undefined,sequentialUploads:false,limitConcurrentUploads:undefined,forceIframeTransport:false,redirect:undefined,redirectParamName:undefined,postMessage:undefined,multipart:true,maxChunkSize:undefined,uploadedBytes:undefined,recalculateProgress:true,progressInterval:100,bitrateInterval:500,autoUpload:true,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(d,a){d=this.messages[d]||d.toString();if(a){b.each(a,function(f,c){d=d.replace("{"+f+"}",c)})}return d},formData:function(a){return a.serializeArray()},add:function(d,a){if(d.isDefaultPrevented()){return false}if(a.autoUpload||(a.autoUpload!==false&&b(this).fileupload("option","autoUpload"))){a.process().done(function(){a.submit()})}},processData:false,contentType:false,cache:false},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:b.support.blobSlice&&function(){var a=this.slice||this.webkitSlice||this.mozSlice;return a.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=((Date.now)?Date.now():(new Date()).getTime());this.loaded=0;this.bitrate=0;this.getBitrate=function(g,h,a){var f=g-this.timestamp;if(!this.bitrate||!a||f>a){this.bitrate=(h-this.loaded)*(1000/f)*8;this.loaded=h;this.timestamp=g}return this.bitrate}},_isXHRUpload:function(a){return !a.forceIframeTransport&&((!a.multipart&&b.support.xhrFileUpload)||b.support.xhrFormDataFileUpload)},_getFormData:function(a){var d;if(typeof a.formData==="function"){return a.formData(a.form)}if(b.isArray(a.formData)){return a.formData}if(b.type(a.formData)==="object"){d=[];b.each(a.formData,function(f,c){d.push({name:f,value:c})});return d}return[]},_getTotal:function(d){var a=0;b.each(d,function(f,c){a+=c.size||1});return a},_initProgressObject:function(d){var a={loaded:0,total:0,bitrate:0};if(d._progress){b.extend(d._progress,a)}else{d._progress=a}},_initResponseObject:function(a){var d;if(a._response){for(d in a._response){if(a._response.hasOwnProperty(d)){delete a._response[d]}}}else{a._response={}}},_onProgress:function(e,g){if(e.lengthComputable){var h=((Date.now)?Date.now():(new Date()).getTime()),a;if(g._time&&g.progressInterval&&(h-g._time<g.progressInterval)&&e.loaded!==e.total){return}g._time=h;a=Math.floor(e.loaded/e.total*(g.chunkSize||g._progress.total))+(g.uploadedBytes||0);this._progress.loaded+=(a-g._progress.loaded);this._progress.bitrate=this._bitrateTimer.getBitrate(h,this._progress.loaded,g.bitrateInterval);g._progress.loaded=g.loaded=a;g._progress.bitrate=g.bitrate=g._bitrateTimer.getBitrate(h,a,g.bitrateInterval);this._trigger("progress",b.Event("progress",{delegatedEvent:e}),g);this._trigger("progressall",b.Event("progressall",{delegatedEvent:e}),this._progress)}},_initProgressListener:function(a){var f=this,e=a.xhr?a.xhr():b.ajaxSettings.xhr();if(e.upload){b(e.upload).bind("progress",function(d){var c=d.originalEvent;d.lengthComputable=c.lengthComputable;d.loaded=c.loaded;d.total=c.total;f._onProgress(d,a)});a.xhr=function(){return e}}},_isInstanceOf:function(a,d){return Object.prototype.toString.call(d)==="[object "+a+"]"},_initXHRData:function(l){var j=this,h,k=l.files[0],a=l.multipart||!b.support.xhrFileUpload,i=l.paramName[0];l.headers=b.extend({},l.headers);if(l.contentRange){l.headers["Content-Range"]=l.contentRange}if(!a||l.blob||!this._isInstanceOf("File",k)){l.headers["Content-Disposition"]='attachment; filename="'+encodeURI(k.name)+'"'}if(!a){l.contentType=k.type;l.data=l.blob||k}else{if(b.support.xhrFormDataFileUpload){if(l.postMessage){h=this._getFormData(l);if(l.blob){h.push({name:i,value:l.blob})}else{b.each(l.files,function(d,c){h.push({name:l.paramName[d]||i,value:c})})}}else{if(j._isInstanceOf("FormData",l.formData)){h=l.formData}else{h=new FormData();b.each(this._getFormData(l),function(d,c){h.append(c.name,c.value)})}if(l.blob){h.append(i,l.blob,k.name)}else{b.each(l.files,function(d,c){if(j._isInstanceOf("File",c)||j._isInstanceOf("Blob",c)){h.append(l.paramName[d]||i,c,c.uploadName||c.name)}})}}l.data=h}}l.blob=null},_initIframeSettings:function(a){var d=b("<a></a>").prop("href",a.url).prop("host");a.dataType="iframe "+(a.dataType||"");a.formData=this._getFormData(a);if(a.redirect&&d&&d!==location.host){a.formData.push({name:a.redirectParamName||"redirect",value:a.redirect})}},_initDataSettings:function(a){if(this._isXHRUpload(a)){if(!this._chunkedUpload(a,true)){if(!a.data){this._initXHRData(a)}this._initProgressListener(a)}if(a.postMessage){a.dataType="postmessage "+(a.dataType||"")}}else{this._initIframeSettings(a)}},_getParamName:function(a){var f=b(a.fileInput),e=a.paramName;if(!e){e=[];f.each(function(){var h=b(this),d=h.prop("name")||"files[]",c=(h.prop("files")||[1]).length;while(c){e.push(d);c-=1}});if(!e.length){e=[f.prop("name")||"files[]"]}}else{if(!b.isArray(e)){e=[e]}}return e},_initFormSettings:function(a){if(!a.form||!a.form.length){a.form=b(a.fileInput.prop("form"));if(!a.form.length){a.form=b(this.options.fileInput.prop("form"))}}a.paramName=this._getParamName(a);if(!a.url){a.url=a.form.prop("action")||location.href}a.type=(a.type||(b.type(a.form.prop("method"))==="string"&&a.form.prop("method"))||"").toUpperCase();if(a.type!=="POST"&&a.type!=="PUT"&&a.type!=="PATCH"){a.type="POST"}if(!a.formAcceptCharset){a.formAcceptCharset=a.form.attr("accept-charset")}},_getAJAXSettings:function(d){var a=b.extend({},this.options,d);this._initFormSettings(a);this._initDataSettings(a);return a},_getDeferredState:function(a){if(a.state){return a.state()}if(a.isResolved()){return"resolved"}if(a.isRejected()){return"rejected"}return"pending"},_enhancePromise:function(a){a.success=a.done;a.error=a.fail;a.complete=a.always;return a},_getXHRPromise:function(h,i,j){var a=b.Deferred(),g=a.promise();i=i||this.options.context||g;if(h===true){a.resolveWith(i,j)}else{if(h===false){a.rejectWith(i,j)}}g.abort=a.promise;return this._enhancePromise(g)},_addConvenienceMethods:function(e,g){var h=this,a=function(c){return b.Deferred().resolveWith(h,c).promise()};g.process=function(c,d){if(c||d){g._processQueue=this._processQueue=(this._processQueue||a([this])).pipe(function(){if(g.errorThrown){return b.Deferred().rejectWith(h,[g]).promise()}return a(arguments)}).pipe(c,d)}return this._processQueue||a([this])};g.submit=function(){if(this.state()!=="pending"){g.jqXHR=this.jqXHR=(h._trigger("submit",b.Event("submit",{delegatedEvent:e}),this)!==false)&&h._onSend(e,this)}return this.jqXHR||h._getXHRPromise()};g.abort=function(){if(this.jqXHR){return this.jqXHR.abort()}this.errorThrown="abort";return h._getXHRPromise()};g.state=function(){if(this.jqXHR){return h._getDeferredState(this.jqXHR)}if(this._processQueue){return h._getDeferredState(this._processQueue)}};g.processing=function(){return !this.jqXHR&&this._processQueue&&h._getDeferredState(this._processQueue)==="pending"};g.progress=function(){return this._progress};g.response=function(){return this._response}},_getUploadedBytes:function(g){var a=g.getResponseHeader("Range"),f=a&&a.split("-"),h=f&&f.length>1&&parseInt(f[1],10);return h&&h+1},_chunkedUpload:function(a,s){a.uploadedBytes=a.uploadedBytes||0;var t=this,v=a.files[0],u=v.size,x=a.uploadedBytes,w=a.maxChunkSize||u,q=this._blobSlice,p=b.Deferred(),n=p.promise(),r,o;if(!(this._isXHRUpload(a)&&q&&(x||w<u))||a.data){return false}if(s){return true}if(x>=u){v.error=a.i18n("uploadedBytes");return this._getXHRPromise(false,a.context,[null,"error",v.error])}o=function(){var c=b.extend({},a),d=c._progress.loaded;c.blob=q.call(v,x,x+w,v.type);c.chunkSize=c.blob.size;c.contentRange="bytes "+x+"-"+(x+c.chunkSize-1)+"/"+u;t._initXHRData(c);t._initProgressListener(c);r=((t._trigger("chunksend",null,c)!==false&&b.ajax(c))||t._getXHRPromise(false,c.context)).done(function(g,e,f){x=t._getUploadedBytes(f)||(x+c.chunkSize);if(d+c.chunkSize-c._progress.loaded){t._onProgress(b.Event("progress",{lengthComputable:true,loaded:x-c.uploadedBytes,total:x-c.uploadedBytes}),c)}a.uploadedBytes=c.uploadedBytes=x;c.result=g;c.textStatus=e;c.jqXHR=f;t._trigger("chunkdone",null,c);t._trigger("chunkalways",null,c);if(x<u){o()}else{p.resolveWith(c.context,[g,e,f])}}).fail(function(g,e,f){c.jqXHR=g;c.textStatus=e;c.errorThrown=f;t._trigger("chunkfail",null,c);t._trigger("chunkalways",null,c);p.rejectWith(c.context,[g,e,f])})};this._enhancePromise(n);n.abort=function(){return r.abort()};o();return n},_beforeSend:function(d,a){if(this._active===0){this._trigger("start");this._bitrateTimer=new this._BitrateTimer();this._progress.loaded=this._progress.total=0;this._progress.bitrate=0}this._initResponseObject(a);this._initProgressObject(a);a._progress.loaded=a.loaded=a.uploadedBytes||0;a._progress.total=a.total=this._getTotal(a.files)||1;a._progress.bitrate=a.bitrate=0;this._active+=1;this._progress.loaded+=a.loaded;this._progress.total+=a.total},_onDone:function(a,h,i,k){var j=k._progress.total,l=k._response;if(k._progress.loaded<j){this._onProgress(b.Event("progress",{lengthComputable:true,loaded:j,total:j}),k)}l.result=k.result=a;l.textStatus=k.textStatus=h;l.jqXHR=k.jqXHR=i;this._trigger("done",null,k)},_onFail:function(i,g,h,j){var a=j._response;if(j.recalculateProgress){this._progress.loaded-=j._progress.loaded;this._progress.total-=j._progress.total}a.jqXHR=j.jqXHR=i;a.textStatus=j.textStatus=g;a.errorThrown=j.errorThrown=h;this._trigger("fail",null,j)},_onAlways:function(g,f,h,a){this._trigger("always",null,a)},_onSend:function(m,o){if(!o.submit){this._addConvenienceMethods(m,o)}var n=this,e,r,l,q,a=n._getAJAXSettings(o),p=function(){n._sending+=1;a._bitrateTimer=new n._BitrateTimer();e=e||(((r||n._trigger("send",b.Event("send",{delegatedEvent:m}),a)===false)&&n._getXHRPromise(false,a.context,r))||n._chunkedUpload(a)||b.ajax(a)).done(function(f,c,d){n._onDone(f,c,d,a)}).fail(function(f,c,d){n._onFail(f,c,d,a)}).always(function(c,g,d){n._onAlways(c,g,d,a);n._sending-=1;n._active-=1;if(a.limitConcurrentUploads&&a.limitConcurrentUploads>n._sending){var f=n._slots.shift();while(f){if(n._getDeferredState(f)==="pending"){f.resolve();break}f=n._slots.shift()}}if(n._active===0){n._trigger("stop")}});return e};this._beforeSend(m,a);if(this.options.sequentialUploads||(this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending)){if(this.options.limitConcurrentUploads>1){l=b.Deferred();this._slots.push(l);q=l.pipe(p)}else{this._sequence=this._sequence.pipe(p,p);q=this._sequence}q.abort=function(){r=[undefined,"abort","abort"];if(!e){if(l){l.rejectWith(a.context,r)}return p()}return e.abort()};return this._enhancePromise(q)}return p()},_onAdd:function(o,r){var p=this,a=true,e=b.extend({},this.options,r),t=e.limitMultiFileUploads,q=this._getParamName(e),u,v,i,s;if(!(e.singleFileUploads||t)||!this._isXHRUpload(e)){i=[r.files];u=[q]}else{if(!e.singleFileUploads&&t){i=[];u=[];for(s=0;s<r.files.length;s+=t){i.push(r.files.slice(s,s+t));v=q.slice(s,s+t);if(!v.length){v=q}u.push(v)}}else{u=q}}r.originalFiles=r.files;b.each(i||r.files,function(d,c){var f=b.extend({},r);f.files=i?c:[c];f.paramName=u[d];p._initResponseObject(f);p._initProgressObject(f);p._addConvenienceMethods(o,f);a=p._trigger("add",b.Event("add",{delegatedEvent:o}),f);return a});return a},_replaceFileInput:function(a){var d=a.clone(true);b("<form></form>").append(d)[0].reset();a.after(d).detach();b.cleanData(a.unbind("remove"));this.options.fileInput=this.options.fileInput.map(function(f,c){if(c===a[0]){return d[0]}return c});if(a[0]===this.element[0]){this.element=d}},_handleFileTreeEntry:function(i,h){var j=this,a=b.Deferred(),l=function(c){if(c&&!c.entry){c.entry=i}a.resolve([c])},k;h=h||"";if(i.isFile){if(i._file){i._file.relativePath=h;a.resolve(i._file)}else{i.file(function(c){c.relativePath=h;a.resolve(c)},l)}}else{if(i.isDirectory){k=i.createReader();k.readEntries(function(c){j._handleFileTreeEntries(c,h+i.name+"/").done(function(d){a.resolve(d)}).fail(l)},l)}else{a.resolve([])}}return a.promise()},_handleFileTreeEntries:function(a,e){var f=this;return b.when.apply(b,b.map(a,function(c){return f._handleFileTreeEntry(c,e)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(d){d=d||{};var a=d.items;if(a&&a.length&&(a[0].webkitGetAsEntry||a[0].getAsEntry)){return this._handleFileTreeEntries(b.map(a,function(c){var f;if(c.webkitGetAsEntry){f=c.webkitGetAsEntry();if(f){f._file=c.getAsFile()}return f}return c.getAsEntry()}))}return b.Deferred().resolve(b.makeArray(d.files)).promise()},_getSingleFileInputFiles:function(g){g=b(g);var a=g.prop("webkitEntries")||g.prop("entries"),h,f;if(a&&a.length){return this._handleFileTreeEntries(a)}h=b.makeArray(g.prop("files"));if(!h.length){f=g.prop("value");if(!f){return b.Deferred().resolve([]).promise()}h=[{name:f.replace(/^.*\\/,"")}]}else{if(h[0].name===undefined&&h[0].fileName){b.each(h,function(d,c){c.name=c.fileName;c.size=c.fileSize})}}return b.Deferred().resolve(h).promise()},_getFileInputFiles:function(a){if(!(a instanceof b)||a.length===1){return this._getSingleFileInputFiles(a)}return b.when.apply(b,b.map(a,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_onChange:function(e){var a=this,f={fileInput:b(e.target),form:b(e.target.form)};this._getFileInputFiles(f.fileInput).always(function(c){f.files=c;if(a.options.replaceFileInput){a._replaceFileInput(f.fileInput)}if(a._trigger("change",b.Event("change",{delegatedEvent:e}),f)!==false){a._onAdd(e,f)}})},_onPaste:function(e){var a=e.originalEvent&&e.originalEvent.clipboardData&&e.originalEvent.clipboardData.items,f={files:[]};if(a&&a.length){b.each(a,function(h,c){var d=c.getAsFile&&c.getAsFile();if(d){f.files.push(d)}});if(this._trigger("paste",b.Event("paste",{delegatedEvent:e}),f)!==false){this._onAdd(e,f)}}},_onDrop:function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var a=this,g=e.dataTransfer,h={};if(g&&g.files&&g.files.length){e.preventDefault();this._getDroppedFiles(g).always(function(c){h.files=c;if(a._trigger("drop",b.Event("drop",{delegatedEvent:e}),h)!==false){a._onAdd(e,h)}})}},_onDragOver:function(d){d.dataTransfer=d.originalEvent&&d.originalEvent.dataTransfer;var a=d.dataTransfer;if(a&&b.inArray("Files",a.types)!==-1&&this._trigger("dragover",b.Event("dragover",{delegatedEvent:d}))!==false){d.preventDefault();a.dropEffect="copy"}},_initEventHandlers:function(){if(this._isXHRUpload(this.options)){this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop});this._on(this.options.pasteZone,{paste:this._onPaste})}if(b.support.fileInput){this._on(this.options.fileInput,{change:this._onChange})}},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop");this._off(this.options.pasteZone,"paste");this._off(this.options.fileInput,"change")},_setOption:function(a,f){var e=b.inArray(a,this._specialOptions)!==-1;if(e){this._destroyEventHandlers()}this._super(a,f);if(e){this._initSpecialOptions();this._initEventHandlers()}},_initSpecialOptions:function(){var a=this.options;if(a.fileInput===undefined){a.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]')}else{if(!(a.fileInput instanceof b)){a.fileInput=b(a.fileInput)}}if(!(a.dropZone instanceof b)){a.dropZone=b(a.dropZone)}if(!(a.pasteZone instanceof b)){a.pasteZone=b(a.pasteZone)}},_getRegExp:function(e){var f=e.split("/"),a=f.pop();f.shift();return new RegExp(f.join("/"),a)},_isRegExpOption:function(a,d){return a!=="url"&&b.type(d)==="string"&&/^\/.*\/[igm]{0,3}$/.test(d)},_initDataAttributes:function(){var d=this,a=this.options;b.each(b(this.element[0].cloneNode(false)).data(),function(f,c){if(d._isRegExpOption(f,c)){c=d._getRegExp(c)}a[f]=c})},_create:function(){this._initDataAttributes();this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(true);this._sending=this._active=0;this._initProgressObject(this);this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(d){var a=this;if(!d||this.options.disabled){return}if(d.fileInput&&!d.files){this._getFileInputFiles(d.fileInput).always(function(c){d.files=c;a._onAdd(null,d)})}else{d.files=b.makeArray(d.files);this._onAdd(null,d)}},send:function(i){if(i&&!this.options.disabled){if(i.fileInput&&!i.files){var k=this,a=b.Deferred(),h=a.promise(),l,j;h.abort=function(){j=true;if(l){return l.abort()}a.reject(null,"abort","abort");return h};this._getFileInputFiles(i.fileInput).always(function(c){if(j){return}if(!c.length){a.reject();return}i.files=c;l=k._onSend(null,i).then(function(f,d,e){a.resolve(f,d,e)},function(f,d,e){a.reject(f,d,e)})});return this._enhancePromise(h)}i.files=b.makeArray(i.files);if(i.files.length){return this._onSend(null,i)}}return this._getXHRPromise(false,i&&i.context)}})}));(function(b){if(typeof define==="function"&&define.amd){define(["jquery","./jquery.fileupload"],b)}else{b(window.jQuery)}}(function(d){var c=d.blueimp.fileupload.prototype.options.add;d.widget("blueimp.fileupload",d.blueimp.fileupload,{options:{processQueue:[],add:function(a,e){var b=d(this);e.process(function(){return b.fileupload("process",e)});c.call(this,a,e)}},processActions:{},_processFile:function(a,b){var h=this,j=d.Deferred().resolveWith(h,[a]),i=j.promise();this._trigger("process",null,a);d.each(a.processQueue,function(g,f){var e=function(k){if(b.errorThrown){return d.Deferred().rejectWith(h,[b]).promise()}return h.processActions[f.action].call(h,k,f)};i=i.pipe(e,f.always&&e)});i.done(function(){h._trigger("processdone",null,a);h._trigger("processalways",null,a)}).fail(function(){h._trigger("processfail",null,a);h._trigger("processalways",null,a)});return i},_transformProcessQueue:function(b){var a=[];d.each(b.processQueue,function(){var j={},h=this.action,i=this.prefix===true?h:this.prefix;d.each(this,function(f,e){if(d.type(e)==="string"&&e.charAt(0)==="@"){j[f]=b[e.slice(1)||(i?i+f.charAt(0).toUpperCase()+f.slice(1):f)]}else{j[f]=e}});a.push(j)});b.processQueue=a},processing:function(){return this._processing},process:function(a){var b=this,f=d.extend({},this.options,a);if(f.processQueue&&f.processQueue.length){this._transformProcessQueue(f);if(this._processing===0){this._trigger("processstart")}d.each(a.files,function(j){var e=j?d.extend({},f):f,i=function(){if(a.errorThrown){return d.Deferred().rejectWith(b,[a]).promise()}return b._processFile(e,a)};e.index=j;b._processing+=1;b._processingQueue=b._processingQueue.pipe(i,i).always(function(){b._processing-=1;if(b._processing===0){b._trigger("processstop")}})})}return this._processingQueue},_create:function(){this._super();this._processing=0;this._processingQueue=d.Deferred().resolveWith(this).promise()}})}));(function(b){if(typeof define==="function"&&define.amd){define(["jquery","load-image","load-image-meta","load-image-exif","load-image-ios","canvas-to-blob","./jquery.fileupload-process"],b)}else{b(window.jQuery,window.loadImage)}}(function(d,c){d.blueimp.fileupload.prototype.options.processQueue.unshift({action:"loadImageMetaData",disableImageHead:"@",disableExif:"@",disableExifThumbnail:"@",disableExifSub:"@",disableExifGps:"@",disabled:"@disableImageMetaDataLoad"},{action:"loadImage",prefix:true,fileTypes:"@",maxFileSize:"@",noRevoke:"@",disabled:"@disableImageLoad"},{action:"resizeImage",prefix:"image",maxWidth:"@",maxHeight:"@",minWidth:"@",minHeight:"@",crop:"@",orientation:"@",forceResize:"@",disabled:"@disableImageResize"},{action:"saveImage",quality:"@imageQuality",type:"@imageType",disabled:"@disableImageResize"},{action:"saveImageMetaData",disabled:"@disableImageMetaDataSave"},{action:"resizeImage",prefix:"preview",maxWidth:"@",maxHeight:"@",minWidth:"@",minHeight:"@",crop:"@",orientation:"@",thumbnail:"@",canvas:"@",disabled:"@disableImagePreview"},{action:"setImage",name:"@imagePreviewName",disabled:"@disableImagePreview"});d.widget("blueimp.fileupload",d.blueimp.fileupload,{options:{loadImageFileTypes:/^image\/(gif|jpeg|png)$/,loadImageMaxFileSize:10000000,imageMaxWidth:1920,imageMaxHeight:1080,imageOrientation:false,imageCrop:false,disableImageResize:true,previewMaxWidth:80,previewMaxHeight:80,previewOrientation:true,previewThumbnail:true,previewCrop:false,previewCanvas:true},processActions:{loadImage:function(a,i){if(i.disabled){return a}var b=this,h=a.files[a.index],j=d.Deferred();if((d.type(i.maxFileSize)==="number"&&h.size>i.maxFileSize)||(i.fileTypes&&!i.fileTypes.test(h.type))||!c(h,function(e){if(e.src){a.img=e}j.resolveWith(b,[a])},i)){return a}return j.promise()},resizeImage:function(b,l){if(l.disabled||!(b.canvas||b.img)){return b}l=d.extend({canvas:true},l);var k=this,n=d.Deferred(),m=(l.canvas&&b.canvas)||b.img,j=function(e){if(e&&(e.width!==m.width||e.height!==m.height||l.forceResize)){b[e.getContext?"canvas":"img"]=e}b.preview=e;n.resolveWith(k,[b])},a;if(b.exif){if(l.orientation===true){l.orientation=b.exif.get("Orientation")}if(l.thumbnail){a=b.exif.get("Thumbnail");if(a){c(a,j,l);return n.promise()}}}if(m){j(c.scale(m,l));return n.promise()}return b},saveImage:function(a,i){if(!a.canvas||i.disabled){return a}var b=this,h=a.files[a.index],j=d.Deferred();if(a.canvas.toBlob){a.canvas.toBlob(function(e){if(!e.name){if(h.type===e.type){e.name=h.name}else{if(h.name){e.name=h.name.replace(/\..+$/,"."+e.type.substr(6))}}}if(h.type!==e.type){delete a.imageHead}a.files[a.index]=e;j.resolveWith(b,[a])},i.type||h.type,i.quality)}else{return a}return j.promise()},loadImageMetaData:function(a,g){if(g.disabled){return a}var b=this,h=d.Deferred();c.parseMetaData(a.files[a.index],function(e){d.extend(a,e);h.resolveWith(b,[a])},g);return h.promise()},saveImageMetaData:function(a,g){if(!(a.imageHead&&a.canvas&&a.canvas.toBlob&&!g.disabled)){return a}var b=a.files[a.index],h=new Blob([a.imageHead,this._blobSlice.call(b,20)],{type:b.type});h.name=b.name;a.files[a.index]=h;return a},setImage:function(a,b){if(a.preview&&!b.disabled){a.files[a.index][b.name||"preview"]=a.preview}return a}}})}));(function(b){if(typeof define==="function"&&define.amd){define(["jquery","./jquery.fileupload-process"],b)}else{b(window.jQuery)}}(function(b){b.blueimp.fileupload.prototype.options.processQueue.push({action:"validate",always:true,acceptFileTypes:"@",maxFileSize:"@",minFileSize:"@",maxNumberOfFiles:"@",disabled:"@disableValidation"});b.widget("blueimp.fileupload",b.blueimp.fileupload,{options:{getNumberOfFiles:b.noop,messages:{maxNumberOfFiles:"Maximum number of files exceeded",acceptFileTypes:"File type not allowed",maxFileSize:"File is too large",minFileSize:"File is too small"}},processActions:{validate:function(h,k){if(k.disabled){return h}var l=b.Deferred(),i=this.options,j=h.files[h.index],a;if(k.minFileSize||k.maxFileSize){a=j.size}if(b.type(k.maxNumberOfFiles)==="number"&&(i.getNumberOfFiles()||0)+h.files.length>k.maxNumberOfFiles){j.error=i.i18n("maxNumberOfFiles")}else{if(k.acceptFileTypes&&!(k.acceptFileTypes.test(j.type)||k.acceptFileTypes.test(j.name))){j.error=i.i18n("acceptFileTypes")}else{if(a>k.maxFileSize){j.error=i.i18n("maxFileSize")}else{if(b.type(a)==="number"&&a<k.minFileSize){j.error=i.i18n("minFileSize")}else{delete j.error}}}}if(j.error||h.files.error){h.files.error=true;l.rejectWith(this,[h])}else{l.resolveWith(this,[h])}return l.promise()}}})}));(function(b){if(typeof define==="function"&&define.amd){define(["jquery","tmpl","./jquery.fileupload-image","./jquery.fileupload-audio","./jquery.fileupload-video","./jquery.fileupload-validate"],b)}else{b(window.jQuery,window.tmpl)}}(function(d,e,f){d.blueimp.fileupload.prototype._specialOptions.push("filesContainer","uploadTemplateId","downloadTemplateId");d.widget("blueimp.fileupload",d.blueimp.fileupload,{options:{autoUpload:false,uploadTemplateId:"template-upload",downloadTemplateId:"template-download",filesContainer:undefined,prependFiles:false,dataType:"json",getNumberOfFiles:function(){return this.filesContainer.children().not(".processing").length},getFilesFromResponse:function(a){if(a.result&&d.isArray(a.result.files)){return a.result.files}return[]},add:function(a,c){if(a.isDefaultPrevented()){return false}var b=d(this),j=b.data("blueimp-fileupload")||b.data("fileupload"),k=j.options;c.context=j._renderUpload(c.files).data("data",c).addClass("processing");k.filesContainer[k.prependFiles?"prepend":"append"](c.context);j._forceReflow(c.context);d.when(j._transition(c.context),c.process(function(){return b.fileupload("process",c)})).always(function(){c.context.each(function(g){d(this).find(".size").text(j._formatFileSize(c.files[g].size))}).removeClass("processing");j._renderPreviews(c)}).done(function(){c.context.find(".start").prop("disabled",false);if((j._trigger("added",a,c)!==false)&&(k.autoUpload||c.autoUpload)&&c.autoUpload!==false){c.submit()}}).fail(function(){if(c.files.error){c.context.each(function(g){var h=c.files[g].error;if(h){d(this).find(".error").text(h)}})}})},send:function(a,b){if(a.isDefaultPrevented()){return false}var c=d(this).data("blueimp-fileupload")||d(this).data("fileupload");if(b.context&&b.dataType&&b.dataType.substr(0,6)==="iframe"){b.context.find(".progress").addClass(!d.support.transition&&"progress-animated").attr("aria-valuenow",100).children().first().css("width","100%")}return c._trigger("sent",a,b)},done:function(a,b){if(a.isDefaultPrevented()){return false}var c=d(this).data("blueimp-fileupload")||d(this).data("fileupload"),n=b.getFilesFromResponse||c.options.getFilesFromResponse,l=n(b),m,o;if(b.context){b.context.each(function(h){var g=l[h]||{error:"Empty file upload result"};o=c._addFinishedDeferreds();c._transition(d(this)).done(function(){var i=d(this);m=c._renderDownload([g]).replaceAll(i);c._forceReflow(m);c._transition(m).done(function(){b.context=d(this);c._trigger("completed",a,b);c._trigger("finished",a,b);o.resolve()})})})}else{m=c._renderDownload(l)[c.options.prependFiles?"prependTo":"appendTo"](c.options.filesContainer);c._forceReflow(m);o=c._addFinishedDeferreds();c._transition(m).done(function(){b.context=d(this);c._trigger("completed",a,b);c._trigger("finished",a,b);o.resolve()})}},fail:function(a,b){if(a.isDefaultPrevented()){return false}var c=d(this).data("blueimp-fileupload")||d(this).data("fileupload"),j,k;if(b.context){b.context.each(function(h){if(b.errorThrown!=="abort"){var g=b.files[h];g.error=g.error||b.errorThrown||true;k=c._addFinishedDeferreds();c._transition(d(this)).done(function(){var i=d(this);j=c._renderDownload([g]).replaceAll(i);c._forceReflow(j);c._transition(j).done(function(){b.context=d(this);c._trigger("failed",a,b);c._trigger("finished",a,b);k.resolve()})})}else{k=c._addFinishedDeferreds();c._transition(d(this)).done(function(){d(this).remove();c._trigger("failed",a,b);c._trigger("finished",a,b);k.resolve()})}})}else{if(b.errorThrown!=="abort"){b.context=c._renderUpload(b.files)[c.options.prependFiles?"prependTo":"appendTo"](c.options.filesContainer).data("data",b);c._forceReflow(b.context);k=c._addFinishedDeferreds();c._transition(b.context).done(function(){b.context=d(this);c._trigger("failed",a,b);c._trigger("finished",a,b);k.resolve()})}else{c._trigger("failed",a,b);c._trigger("finished",a,b);c._addFinishedDeferreds().resolve()}}},progress:function(a,b){if(a.isDefaultPrevented()){return false}var c=Math.floor(b.loaded/b.total*100);if(b.context){b.context.each(function(){d(this).find(".progress").attr("aria-valuenow",c).children().first().css("width",c+"%")})}},progressall:function(b,k){if(b.isDefaultPrevented()){return false}var c=d(this),l=Math.floor(k.loaded/k.total*100),m=c.find(".fileupload-progress"),a=m.find(".progress-extended");if(a.length){a.html((c.data("blueimp-fileupload")||c.data("fileupload"))._renderExtendedProgress(k))}m.find(".progress").attr("aria-valuenow",l).children().first().css("width",l+"%")},start:function(a){if(a.isDefaultPrevented()){return false}var b=d(this).data("blueimp-fileupload")||d(this).data("fileupload");b._resetFinishedDeferreds();b._transition(d(this).find(".fileupload-progress")).done(function(){b._trigger("started",a)})},stop:function(a){if(a.isDefaultPrevented()){return false}var b=d(this).data("blueimp-fileupload")||d(this).data("fileupload"),c=b._addFinishedDeferreds();d.when.apply(d,b._getFinishedDeferreds()).done(function(){b._trigger("stopped",a)});b._transition(d(this).find(".fileupload-progress")).done(function(){d(this).find(".progress").attr("aria-valuenow","0").children().first().css("width","0%");d(this).find(".progress-extended").html("&nbsp;");c.resolve()})},processstart:function(a){if(a.isDefaultPrevented()){return false}d(this).addClass("fileupload-processing")},processstop:function(a){if(a.isDefaultPrevented()){return false}d(this).removeClass("fileupload-processing")},destroy:function(b,c){if(b.isDefaultPrevented()){return false}var i=d(this).data("blueimp-fileupload")||d(this).data("fileupload"),a=function(){i._transition(c.context).done(function(){d(this).remove();i._trigger("destroyed",b,c)})};if(c.url){c.dataType=c.dataType||i.options.dataType;d.ajax(c).done(a)}else{a()}}},_resetFinishedDeferreds:function(){this._finishedUploads=[]},_addFinishedDeferreds:function(a){if(!a){a=d.Deferred()}this._finishedUploads.push(a);return a},_getFinishedDeferreds:function(){return this._finishedUploads},_enableDragToDesktop:function(){var a=d(this),c=a.prop("href"),h=a.prop("download"),b="application/octet-stream";a.bind("dragstart",function(j){try{j.originalEvent.dataTransfer.setData("DownloadURL",[b,h,c].join(":"))}catch(g){}})},_formatFileSize:function(a){if(typeof a!=="number"){return""}if(a>=1000000000){return(a/1000000000).toFixed(2)+" GB"}if(a>=1000000){return(a/1000000).toFixed(2)+" MB"}return(a/1000).toFixed(2)+" KB"},_formatBitrate:function(a){if(typeof a!=="number"){return""}if(a>=1000000000){return(a/1000000000).toFixed(2)+" Gbit/s"}if(a>=1000000){return(a/1000000).toFixed(2)+" Mbit/s"}if(a>=1000){return(a/1000).toFixed(2)+" kbit/s"}return a.toFixed(2)+" bit/s"},_formatTime:function(b){var c=new Date(b*1000),a=Math.floor(b/86400);a=a?a+"d ":"";return a+("0"+c.getUTCHours()).slice(-2)+":"+("0"+c.getUTCMinutes()).slice(-2)+":"+("0"+c.getUTCSeconds()).slice(-2)},_formatPercentage:function(a){return(a*100).toFixed(2)+" %"},_renderExtendedProgress:function(a){return this._formatBitrate(a.bitrate)+" | "+this._formatTime((a.total-a.loaded)*8/a.bitrate)+" | "+this._formatPercentage(a.loaded/a.total)+" | "+this._formatFileSize(a.loaded)+" / "+this._formatFileSize(a.total)},_renderTemplate:function(a,b){if(!a){return d()}var c=a({files:b,formatFileSize:this._formatFileSize,options:this.options});if(c instanceof d){return c}return d(this.options.templatesContainer).html(c).children()},_renderPreviews:function(a){a.context.find(".preview").each(function(c,b){d(b).append(a.files[c].preview)})},_renderUpload:function(a){return this._renderTemplate(this.options.uploadTemplate,a)},_renderDownload:function(a){return this._renderTemplate(this.options.downloadTemplate,a).find("a[download]").each(this._enableDragToDesktop).end()},_startHandler:function(a){a.preventDefault();var i=d(a.currentTarget),c=i.closest(".template-upload"),b=c.data("data");i.prop("disabled",true);if(b&&b.submit){b.submit()}},_cancelHandler:function(a){a.preventDefault();var c=d(a.currentTarget).closest(".template-upload,.template-download"),b=c.data("data")||{};if(!b.jqXHR){b.context=b.context||c;b.errorThrown="abort";this._trigger("fail",a,b)}else{b.jqXHR.abort()}},_deleteHandler:function(a){a.preventDefault();var b=d(a.currentTarget);this._trigger("destroy",a,d.extend({context:b.closest(".template-download"),type:"DELETE"},b.data()))},_forceReflow:function(a){return d.support.transition&&a.length&&a[0].offsetWidth},_transition:function(a){var b=d.Deferred();if(d.support.transition&&a.hasClass("fade")&&a.is(":visible")){a.bind(d.support.transition.end,function(c){if(c.target===a[0]){a.unbind(d.support.transition.end);b.resolveWith(a)}}).toggleClass("in")}else{a.toggleClass("in");b.resolveWith(a)}return b},_initButtonBarEventHandlers:function(){var b=this.element.find(".fileupload-buttonbar"),a=this.options.filesContainer;this._on(b.find(".start"),{click:function(c){c.preventDefault();a.find(".start").click()}});this._on(b.find(".cancel"),{click:function(c){c.preventDefault();a.find(".cancel").click()}});this._on(b.find(".delete"),{click:function(c){c.preventDefault();a.find(".toggle:checked").closest(".template-download").find(".delete").click();b.find(".toggle").prop("checked",false)}});this._on(b.find(".toggle"),{change:function(c){a.find(".toggle").prop("checked",d(c.currentTarget).is(":checked"))}})},_destroyButtonBarEventHandlers:function(){this._off(this.element.find(".fileupload-buttonbar").find(".start, .cancel, .delete"),"click");this._off(this.element.find(".fileupload-buttonbar .toggle"),"change.")},_initEventHandlers:function(){this._super();this._on(this.options.filesContainer,{"click .start":this._startHandler,"click .cancel":this._cancelHandler,"click .delete":this._deleteHandler});this._initButtonBarEventHandlers()},_destroyEventHandlers:function(){this._destroyButtonBarEventHandlers();this._off(this.options.filesContainer,"click");this._super()},_enableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",false).parent().removeClass("disabled")},_disableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",true).parent().addClass("disabled")},_initTemplates:function(){var a=this.options;a.templatesContainer=this.document[0].createElement(a.filesContainer.prop("nodeName"));if(e){if(a.uploadTemplateId){a.uploadTemplate=e(a.uploadTemplateId)}if(a.downloadTemplateId){a.downloadTemplate=e(a.downloadTemplateId)}}},_initFilesContainer:function(){var a=this.options;if(a.filesContainer===undefined){a.filesContainer=this.element.find(".files")}else{if(!(a.filesContainer instanceof d)){a.filesContainer=d(a.filesContainer)}}},_initSpecialOptions:function(){this._super();this._initFilesContainer();this._initTemplates()},_create:function(){this._super();this._resetFinishedDeferreds();if(!d.support.fileInput){this._disableFileInputButton()}},enable:function(){var a=false;if(this.options.disabled){a=true}this._super();if(a){this.element.find("input, button").prop("disabled",false);this._enableFileInputButton()}},disable:function(){if(!this.options.disabled){this.element.find("input, button").prop("disabled",true);this._disableFileInputButton()}this._super()}})}));(function(b){if(typeof define==="function"&&define.amd){define(["jquery","tmpl","./jquery.fileupload-image","./jquery.fileupload-audio","./jquery.fileupload-video","./jquery.fileupload-validate"],b)}else{b(window.jQuery,window.tmpl)}}(function(d,e,f){d.blueimp.fileupload.prototype._specialOptions.push("filesContainer","uploadTemplateId","downloadTemplateId");d.widget("blueimp.fileupload",d.blueimp.fileupload,{options:{autoUpload:false,uploadTemplateId:"template-upload",downloadTemplateId:"template-download",filesContainer:undefined,prependFiles:false,dataType:"json",getNumberOfFiles:function(){return this.filesContainer.children().not(".processing").length},getFilesFromResponse:function(a){if(a.result&&d.isArray(a.result.files)){return a.result.files}return[]},add:function(a,c){if(a.isDefaultPrevented()){return false}var b=d(this),j=b.data("blueimp-fileupload")||b.data("fileupload"),k=j.options;c.context=j._renderUpload(c.files).data("data",c).addClass("processing");k.filesContainer[k.prependFiles?"prepend":"append"](c.context);j._forceReflow(c.context);d.when(j._transition(c.context),c.process(function(){return b.fileupload("process",c)})).always(function(){c.context.each(function(g){d(this).find(".size").text(j._formatFileSize(c.files[g].size))}).removeClass("processing");j._renderPreviews(c)}).done(function(){c.context.find(".start").prop("disabled",false);if((j._trigger("added",a,c)!==false)&&(k.autoUpload||c.autoUpload)&&c.autoUpload!==false){c.submit()}}).fail(function(){if(c.files.error){c.context.each(function(g){var h=c.files[g].error;if(h){d(this).find(".error").text(h)}})}})},send:function(a,b){if(a.isDefaultPrevented()){return false}var c=d(this).data("blueimp-fileupload")||d(this).data("fileupload");if(b.context&&b.dataType&&b.dataType.substr(0,6)==="iframe"){b.context.find(".progress").addClass(!d.support.transition&&"progress-animated").attr("aria-valuenow",100).children().first().css("width","100%")}return c._trigger("sent",a,b)},done:function(a,b){if(a.isDefaultPrevented()){return false}var c=d(this).data("blueimp-fileupload")||d(this).data("fileupload"),n=b.getFilesFromResponse||c.options.getFilesFromResponse,l=n(b),m,o;if(b.context){b.context.each(function(h){var g=l[h]||{error:"Empty file upload result"};o=c._addFinishedDeferreds();c._transition(d(this)).done(function(){var i=d(this);m=c._renderDownload([g]).replaceAll(i);c._forceReflow(m);c._transition(m).done(function(){b.context=d(this);c._trigger("completed",a,b);c._trigger("finished",a,b);o.resolve()})})})}else{m=c._renderDownload(l)[c.options.prependFiles?"prependTo":"appendTo"](c.options.filesContainer);c._forceReflow(m);o=c._addFinishedDeferreds();c._transition(m).done(function(){b.context=d(this);c._trigger("completed",a,b);c._trigger("finished",a,b);o.resolve()})}},fail:function(a,b){if(a.isDefaultPrevented()){return false}var c=d(this).data("blueimp-fileupload")||d(this).data("fileupload"),j,k;if(b.context){b.context.each(function(h){if(b.errorThrown!=="abort"){var g=b.files[h];g.error=g.error||b.errorThrown||true;k=c._addFinishedDeferreds();c._transition(d(this)).done(function(){var i=d(this);j=c._renderDownload([g]).replaceAll(i);c._forceReflow(j);c._transition(j).done(function(){b.context=d(this);c._trigger("failed",a,b);c._trigger("finished",a,b);k.resolve()})})}else{k=c._addFinishedDeferreds();c._transition(d(this)).done(function(){d(this).remove();c._trigger("failed",a,b);c._trigger("finished",a,b);k.resolve()})}})}else{if(b.errorThrown!=="abort"){b.context=c._renderUpload(b.files)[c.options.prependFiles?"prependTo":"appendTo"](c.options.filesContainer).data("data",b);c._forceReflow(b.context);k=c._addFinishedDeferreds();c._transition(b.context).done(function(){b.context=d(this);c._trigger("failed",a,b);c._trigger("finished",a,b);k.resolve()})}else{c._trigger("failed",a,b);c._trigger("finished",a,b);c._addFinishedDeferreds().resolve()}}},progress:function(a,b){if(a.isDefaultPrevented()){return false}var c=Math.floor(b.loaded/b.total*100);if(b.context){b.context.each(function(){d(this).find(".progress").attr("aria-valuenow",c).children().first().css("width",c+"%")})}},progressall:function(b,k){if(b.isDefaultPrevented()){return false}var c=d(this),l=Math.floor(k.loaded/k.total*100),m=c.find(".fileupload-progress"),a=m.find(".progress-extended");if(a.length){a.html((c.data("blueimp-fileupload")||c.data("fileupload"))._renderExtendedProgress(k))}m.find(".progress").attr("aria-valuenow",l).children().first().css("width",l+"%")},start:function(a){if(a.isDefaultPrevented()){return false}var b=d(this).data("blueimp-fileupload")||d(this).data("fileupload");b._resetFinishedDeferreds();b._transition(d(this).find(".fileupload-progress")).done(function(){b._trigger("started",a)})},stop:function(a){if(a.isDefaultPrevented()){return false}var b=d(this).data("blueimp-fileupload")||d(this).data("fileupload"),c=b._addFinishedDeferreds();d.when.apply(d,b._getFinishedDeferreds()).done(function(){b._trigger("stopped",a)});b._transition(d(this).find(".fileupload-progress")).done(function(){d(this).find(".progress").attr("aria-valuenow","0").children().first().css("width","0%");d(this).find(".progress-extended").html("&nbsp;");c.resolve()})},processstart:function(a){if(a.isDefaultPrevented()){return false}d(this).addClass("fileupload-processing")},processstop:function(a){if(a.isDefaultPrevented()){return false}d(this).removeClass("fileupload-processing")},destroy:function(b,c){if(b.isDefaultPrevented()){return false}var i=d(this).data("blueimp-fileupload")||d(this).data("fileupload"),a=function(){i._transition(c.context).done(function(){d(this).remove();i._trigger("destroyed",b,c)})};if(c.url){c.dataType=c.dataType||i.options.dataType;d.ajax(c).done(a)}else{a()}}},_resetFinishedDeferreds:function(){this._finishedUploads=[]},_addFinishedDeferreds:function(a){if(!a){a=d.Deferred()}this._finishedUploads.push(a);return a},_getFinishedDeferreds:function(){return this._finishedUploads},_enableDragToDesktop:function(){var a=d(this),c=a.prop("href"),h=a.prop("download"),b="application/octet-stream";a.bind("dragstart",function(j){try{j.originalEvent.dataTransfer.setData("DownloadURL",[b,h,c].join(":"))}catch(g){}})},_formatFileSize:function(a){if(typeof a!=="number"){return""}if(a>=1000000000){return(a/1000000000).toFixed(2)+" GB"}if(a>=1000000){return(a/1000000).toFixed(2)+" MB"}return(a/1000).toFixed(2)+" KB"},_formatBitrate:function(a){if(typeof a!=="number"){return""}if(a>=1000000000){return(a/1000000000).toFixed(2)+" Gbit/s"}if(a>=1000000){return(a/1000000).toFixed(2)+" Mbit/s"}if(a>=1000){return(a/1000).toFixed(2)+" kbit/s"}return a.toFixed(2)+" bit/s"},_formatTime:function(b){var c=new Date(b*1000),a=Math.floor(b/86400);a=a?a+"d ":"";return a+("0"+c.getUTCHours()).slice(-2)+":"+("0"+c.getUTCMinutes()).slice(-2)+":"+("0"+c.getUTCSeconds()).slice(-2)},_formatPercentage:function(a){return(a*100).toFixed(2)+" %"},_renderExtendedProgress:function(a){return this._formatBitrate(a.bitrate)+" | "+this._formatTime((a.total-a.loaded)*8/a.bitrate)+" | "+this._formatPercentage(a.loaded/a.total)+" | "+this._formatFileSize(a.loaded)+" / "+this._formatFileSize(a.total)},_renderTemplate:function(a,b){if(!a){return d()}var c=a({files:b,formatFileSize:this._formatFileSize,options:this.options});if(c instanceof d){return c}return d(this.options.templatesContainer).html(c).children()},_renderPreviews:function(a){a.context.find(".preview").each(function(c,b){d(b).append(a.files[c].preview)})},_renderUpload:function(a){return this._renderTemplate(this.options.uploadTemplate,a)},_renderDownload:function(a){return this._renderTemplate(this.options.downloadTemplate,a).find("a[download]").each(this._enableDragToDesktop).end()},_startHandler:function(a){a.preventDefault();var i=d(a.currentTarget),c=i.closest(".template-upload"),b=c.data("data");i.prop("disabled",true);if(b&&b.submit){b.submit()}},_cancelHandler:function(a){a.preventDefault();var c=d(a.currentTarget).closest(".template-upload,.template-download"),b=c.data("data")||{};if(!b.jqXHR){b.context=b.context||c;b.errorThrown="abort";this._trigger("fail",a,b)}else{b.jqXHR.abort()}},_deleteHandler:function(a){a.preventDefault();var b=d(a.currentTarget);this._trigger("destroy",a,d.extend({context:b.closest(".template-download"),type:"DELETE"},b.data()))},_forceReflow:function(a){return d.support.transition&&a.length&&a[0].offsetWidth},_transition:function(a){var b=d.Deferred();if(d.support.transition&&a.hasClass("fade")&&a.is(":visible")){a.bind(d.support.transition.end,function(c){if(c.target===a[0]){a.unbind(d.support.transition.end);b.resolveWith(a)}}).toggleClass("in")}else{a.toggleClass("in");b.resolveWith(a)}return b},_initButtonBarEventHandlers:function(){var b=this.element.find(".fileupload-buttonbar"),a=this.options.filesContainer;this._on(b.find(".start"),{click:function(c){c.preventDefault();a.find(".start").click()}});this._on(b.find(".cancel"),{click:function(c){c.preventDefault();a.find(".cancel").click()}});this._on(b.find(".delete"),{click:function(c){c.preventDefault();a.find(".toggle:checked").closest(".template-download").find(".delete").click();b.find(".toggle").prop("checked",false)}});this._on(b.find(".toggle"),{change:function(c){a.find(".toggle").prop("checked",d(c.currentTarget).is(":checked"))}})},_destroyButtonBarEventHandlers:function(){this._off(this.element.find(".fileupload-buttonbar").find(".start, .cancel, .delete"),"click");this._off(this.element.find(".fileupload-buttonbar .toggle"),"change.")},_initEventHandlers:function(){this._super();this._on(this.options.filesContainer,{"click .start":this._startHandler,"click .cancel":this._cancelHandler,"click .delete":this._deleteHandler});this._initButtonBarEventHandlers()},_destroyEventHandlers:function(){this._destroyButtonBarEventHandlers();this._off(this.options.filesContainer,"click");this._super()},_enableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",false).parent().removeClass("disabled")},_disableFileInputButton:function(){this.element.find(".fileinput-button input").prop("disabled",true).parent().addClass("disabled")},_initTemplates:function(){var a=this.options;a.templatesContainer=this.document[0].createElement(a.filesContainer.prop("nodeName"));if(e){if(a.uploadTemplateId){a.uploadTemplate=e(a.uploadTemplateId)}if(a.downloadTemplateId){a.downloadTemplate=e(a.downloadTemplateId)}}},_initFilesContainer:function(){var a=this.options;if(a.filesContainer===undefined){a.filesContainer=this.element.find(".files")}else{if(!(a.filesContainer instanceof d)){a.filesContainer=d(a.filesContainer)}}},_initSpecialOptions:function(){this._super();this._initFilesContainer();this._initTemplates()},_create:function(){this._super();this._resetFinishedDeferreds();if(!d.support.fileInput){this._disableFileInputButton()}},enable:function(){var a=false;if(this.options.disabled){a=true}this._super();if(a){this.element.find("input, button").prop("disabled",false);this._enableFileInputButton()}},disable:function(){if(!this.options.disabled){this.element.find("input, button").prop("disabled",true);this._disableFileInputButton()}this._super()}})}));(function(b){if(typeof console==="undefined"||typeof console.log==="undefined"){console={};console.log=function(){}}b.fn.tagsManager=function(Y,P){var O=this;var i="";var H={prefilled:null,CapitalizeFirstLetter:false,preventSubmitOnEnter:true,isClearInputOnEsc:true,AjaxPush:null,AjaxPushAllTags:null,AjaxPushParameters:null,delimiters:[9,13,44],backspace:[8],maxTags:0,hiddenTagListName:null,hiddenTagListId:null,replace:true,output:null,deleteTagsOnBackspace:true,tagsContainer:null,tagCloseIcon:"x",tagClass:"",validator:null,onlyTagList:false};if(!(0 in this)){return this}if(typeof Y=="string"){H=O.data("tm_options")}else{b.extend(H,Y);O.data("tm_options",H)}if(typeof Y=="string"){i=O.data("tm_rndid")}else{var ah="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";for(var a=0;a<5;a++){i+=ah.charAt(Math.floor(Math.random()*ah.length))}O.data("tm_rndid",i)}if(H.replace===true&&H.hiddenTagListName===null){var I=O.attr("name");H.hiddenTagListName=I;O.attr("name","display-"+i)}if(H.hiddenTagListName===null){H.hiddenTagListName="hidden-"+i}var V=H.delimeters||H.delimiters;var af=[9,13,17,18,19,37,38,39,40];var X=[],ab=[];b.each(V,function(c,d){if(b.inArray(d,af)!=-1){ab.push(d)}else{X.push(d)}});var K=String.fromCharCode(X[0]||44);var ac=H.backspace;var G="tm-tag";var aa="tm-input";if(b.isFunction(H.validator)){O.data("validator",H.validator)}var Q=function(){var c=G;if(O.attr("class")){b.each(O.attr("class").split(" "),function(e,d){if(d.indexOf(aa+"-")!=-1){c+=" "+G+d.substring(aa.length)}})}c+=(H.tagClass?" "+H.tagClass:"");return c};var U=function(d){d=b.trim(d);var c=0;for(c;c<d.length;c++){if(b.inArray(d.charCodeAt(c),X)!=-1){break}}return d.substring(0,c)};var T=function(){var c=O.data("tlis");if(H.maxTags>0&&c.length<H.maxTags){O.show();O.trigger("tm:show")}if(H.maxTags>0&&c.length>=H.maxTags){O.hide();O.trigger("tm:hide")}};var W=function(){var c=O.data("tlis");var e=O.data("tlid");if(e.length>0){var d=e.pop();var f=c[c.length-1];O.trigger("tm:beforePop",f);c.pop();b("#"+i+"_"+d).remove();Z();O.trigger("tm:afterPop",f)}T()};var S=function(){var d=O.data("tlis");var c=O.data("tlid");while(c.length>0){var e=c.pop();d.pop();b("#"+i+"_"+e).remove();Z()}O.trigger("tm:emptied",null);T()};var Z=function(){var d=O.data("tlis");var c=O.data("lhiddenTagList");if(c){b(c).val(d.join(K)).change()}O.trigger("tm:refresh",d.join(K))};var M=function(f){var d=O.data("tlis");var e=O.data("tlid");var c=b.inArray(f,e);if(-1!=c){var g=d[c];O.trigger("tm:beforeSplice",g);b("#"+i+"_"+f).remove();d.splice(c,1);e.splice(c,1);Z();O.trigger("tm:afterSplice",g)}T()};var J=function(d,c){if(H.AjaxPushAllTags){if(d.type!="tm:afterPush"||b.inArray(c,H.prefilled)==-1){var e=O.data("tlis");b.post(H.AjaxPush,{tags:e.join(K)})}}};var N=function(c,r){c=U(c);if(!c||c.length<=0){return}if(H.CapitalizeFirstLetter&&c.length>1){c=c.charAt(0).toUpperCase()+c.slice(1).toLowerCase()}if(O.data("validator")&&!O.data("validator")(c)){return}var h=O.data("tlis");var o=O.data("tlid");if(H.maxTags>0&&h.length>=H.maxTags){return}var f=false;var n=h.map(function(u){return u.toLowerCase()});var s=b.inArray(c.toLowerCase(),n);if(-1!=s){f=true}if(f){var m=o[s];b("#"+i+"_"+m).stop().animate({backgroundColor:H.blinkBGColor_1},100).animate({backgroundColor:H.blinkBGColor_2},100).animate({backgroundColor:H.blinkBGColor_1},100).animate({backgroundColor:H.blinkBGColor_2},100).animate({backgroundColor:H.blinkBGColor_1},100).animate({backgroundColor:H.blinkBGColor_2},100)}else{if(!r){O.trigger("tm:beforePush",c)}var e=Math.max.apply(null,o);e=e==-Infinity?0:e;var p=++e;h.push(c);o.push(p);if(!r){if(H.AjaxPush!=null){if(b.inArray(c,H.prefilled)==-1){b.post(H.AjaxPush,b.extend({tag:c},H.AjaxPushParameters))}}}var j=i+"_"+p;var t=i+"_Remover_"+p;var g=b("<span></span>").text(c).html();var k='<span class="'+Q()+'" id="'+j+'">';k+="<span>"+g+"</span>";k+='<a href="#" class="tm-tag-remove" id="'+t+'" TagIdToRemove="'+p+'">';k+=H.tagCloseIcon+"</a></span> ";var d=b(k);if(H.tagsContainer!=null){b(H.tagsContainer).append(d)}else{if(p>1){var q=p-1;var l=b("#"+i+"_"+q);l.after(d)}else{O.before(d)}}d.find("#"+t).on("click",O,function(v){v.preventDefault();var u=parseInt(b(this).attr("TagIdToRemove"));M(u,v.data)});Z();if(!r){O.trigger("tm:afterPush",c)}T()}O.val("")};var R=function(c){b.each(c,function(e,d){N(d,true)})};var ad=function(c){c.cancelBubble=true;c.returnValue=false;c.stopPropagation();c.preventDefault()};var ae=function(d,c){return b.inArray(d.which,c)!=-1};var ag=function(c){N(O.val());c.preventDefault()};var L=null;this.each(function(){if(typeof Y=="string"){switch(Y){case"empty":S();break;case"popTag":W();break;case"pushTag":N(P);break;case"tags":L={tags:O.data("tlis")};break}return}if(b(this).data("tagManager")){return false}b(this).data("tagManager",true);var c=new Array();var e=new Array();O.data("tlis",c);O.data("tlid",e);if(H.output==null){var f=jQuery("<input/>",{type:"hidden",name:H.hiddenTagListName});O.after(f);O.data("lhiddenTagList",f)}else{O.data("lhiddenTagList",jQuery(H.output))}if(H.AjaxPushAllTags){O.on("tm:afterSplice",J);O.on("tm:afterPop",J);O.on("tm:afterPush",J)}O.on("focus keypress",function(g){if(b(this).popover){b(this).popover("hide")}});if(H.isClearInputOnEsc){O.on("keyup",function(g){if(g.which==27){b(this).val("");ad(g)}})}O.on("keypress",function(g){if(ae(g,X)){ag(g)}});O.on("keydown",function(g){if(g.which==13){if(H.preventSubmitOnEnter){ad(g)}}if(ae(g,ab)){ag(g)}});if(H.deleteTagsOnBackspace){O.on("keydown",function(g){if(ae(g,ac)){if(b(this).val().length<=0){W();ad(g)}}})}O.change(function(g){if(!/webkit/.test(navigator.userAgent.toLowerCase())){b(this).focus()}ad(g)});if(H.prefilled!=null){if(typeof(H.prefilled)=="object"){R(H.prefilled)}else{if(typeof(H.prefilled)=="string"){R(H.prefilled.split(K))}else{if(typeof(H.prefilled)=="function"){R(H.prefilled())}}}}else{if(H.output!=null){if(jQuery(H.output)&&jQuery(H.output).val()){var d=jQuery(H.output)}R(jQuery(H.output).val().split(K))}}});if(!L){L=this}return L}})(jQuery);